select *
from patient.public.shop




SELECT distinct(gender) as gender,
       count(patient_id) as patient_id,
       admission_type,
       readmission,
       PREVIOUS_ADMISSIONS,
       round(avg(blood_pressure)) as avg_BP,
       round(avg(blood_sugar_levels)) as avg_sugar_level,
       round((sum(case when readmission = 'true' then 1 else 0 end)) * 100.0 / count(*)) as readmission_rate,
       round(avg(length_of_stay)) as avg_length_of_stay,

       CASE
          WHEN AGE BETWEEN 0 AND 10 THEN 'CHILD'
          WHEN AGE BETWEEN 11 AND 18 THEN 'TEENAGE'
          WHEN AGE BETWEEN 19 AND 35 THEN 'YOUTH'
          WHEN AGE BETWEEN 45 AND 60 THEN 'ELDERLY'
       ELSE 'TOO OLD'
       END AS AGE_BUCKET,

       
 CASE
    WHEN LENGTH_OF_STAY BETWEEN 0 AND 5 THEN 'SHORT PERIOD' 
    WHEN LENGTH_OF_STAY BETWEEN 6 AND 15 THEN 'MEDIUM PERIOD'
ELSE 'LONG PERIOD'
END AS LENGTH_OF_STAY_BUCKET,

CASE
   WHEN BLOOD_PRESSURE < 90 THEN 'LOW BLOOD PRESSURE'
   WHEN BLOOD_PRESSURE BETWEEN 90 AND 119 THEN 'NORMAL'
   WHEN BLOOD_PRESSURE BETWEEN 120 AND 129 THEN 'ELEVATED'
   WHEN BLOOD_PRESSURE BETWEEN 130 AND 139 THEN 'HYPERTENSION STAGE 1'
   WHEN BLOOD_PRESSURE >= 140 THEN 'HYPERTENSION STAGE 2'
   ELSE 'UNKNOWN'
END AS BLOOD_PRESSURE_STATUS,

CASE 
   WHEN BLOOD_SUGAR_LEVELS < 70 THEN 'LOW'
   WHEN BLOOD_SUGAR_LEVELS BETWEEN 70 AND 99 THEN 'NORMAL'
   WHEN BLOOD_SUGAR_LEVELS BETWEEN 100 AND 125 THEN 'PREDIABETIC'
   WHEN BLOOD_SUGAR_LEVELS >= 126 THEN 'DIABETIC'
   ELSE 'UNKNOWN'
END AS BLOOD_SUGAR_STATUS,

CASE
   WHEN NUMBER_OF_DIAGNOSES = 1 THEN 'SINGLE DIAGNOSES'
   WHEN NUMBER_OF_DIAGNOSES BETWEEN 2 AND 3 THEN 'FEW DIAGNOSES'
   WHEN NUMBER_OF_DIAGNOSES BETWEEN 4 AND 5 THEN 'MULTIPLE DAIGNOSES'
   WHEN NUMBER_OF_DIAGNOSES > 5 THEN 'COMPLEX CASE'
   ELSE 'NO DIAGNOSIS RECORDED'
END AS DIAGNOSES_CATEGORY
 
FROM
  "PATIENT"."PUBLIC"."SHOP"
  group by all;
  
